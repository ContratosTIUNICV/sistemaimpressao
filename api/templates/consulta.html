<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}" />
    <title>Consulta</title>
</head>
<body>
    <!-- Botões de Navegação -->
    <a href="{{ url_for('logout') }}">
        <button class="logout-btn">Logout</button>
    </a>
    <div class="usuario-logado">
        <p>{{ session['usuario'] }}</p>
    </div>
    <div class="nav-buttons">
        <button type="button" onclick="window.location.href='/consulta'">Consultar Aluno</button>
        <button type="button" onclick="window.location.href='/cadastro'">Cadastrar Aluno</button>
        <button type="button" onclick="window.location.href='/recarga'">Efetuar Recarga</button>
        <button type="button" onclick="window.location.href='/debito'">Debitar Saldo</button>
    </div>

    <div class="container">
        <h1>Consulta de Aluno</h1>
        <form method="POST">
            <label for="ra-resumo">RA:</label>
            <input type="number" name="ra" id="ra-resumo" placeholder="Digite o RA do aluno" required>
            <input type="hidden" name="acao" value="resumo">
            <button type="submit">Consultar Resumo</button>
        </form>
        {% if mensagem_erro %}
        <div class="error">
            <p>{{ mensagem_erro }}</p>
            <div class="button-group">
                <button type="button" onclick="window.location.href='/consulta'">Não</button>
                <button type="button" onclick="window.location.href='/cadastro'">Sim</button>
            </div>
        </div>
        {% endif %}
    </div>

    {% if aluno_resumo %}
    <div class="result">
        <h2>Resumo do Aluno</h2>
        <p><strong>Nome:</strong> {{ aluno_resumo['nome'] }}</p>
        <p><strong>RA:</strong> {{ aluno_resumo['ra'] }}</p>
        <p><strong>Saldo Disponível:</strong> {{ aluno_resumo['saldo'] }}</p>
    </div>
    {% endif %}

    <!-- Exibir Histórico -->
    {% if historico_aluno %}
    <div class="historico">
        <h2>Histórico Completo de Transações</h2>
        <table>
            <thead>
                <tr>
                    <th>Nome</th>
                    <th>RA</th>
                    <th>Descrição</th>
                    <th>Saldo Inicial</th>
                    <th>Recarga/Débito</th>
                    <th>Saldo Final</th>
                    <th>Data</th>
                    <th>Usuário Responsável</th>
                </tr>
            </thead>
            <tbody>
                {% for transacao in historico_aluno %}
                <tr>
                    <td>{{ transacao['Nome'] }}</td>
                    <td>{{ transacao['RA'] }}</td>
                    <td>{{ transacao['Descrição'] }}</td>
                    <td>{{ transacao['Saldo Inicial'] }}</td>
                    <td>{{ transacao['Recarga/Débito'] }}</td>
                    <td>{{ transacao['Saldo Final'] }}</td>
                    <td>{{ transacao['Data'] }}</td>
                    <td>{{ transacao['Usuario Responsável'] }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        {% endif %}

    </div>
</body>

</html>